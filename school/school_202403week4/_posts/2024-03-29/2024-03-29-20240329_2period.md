---
title: "2024년 03월 29일 2교시 요약"
tag: 202403_school
use_math: true
---

## 실전

### 모델 생성 & 학습

```python
import numpy as np
import pandas as pd
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Flatten, Dense
from tensorflow.keras.optimizers import SGD

x_data = np.array([1,3,5,7,9]).reshape((5,1))
t_data = np.array([3,5,7,9,11]).reshape((5,1))

model = Sequential()

model.add( Flatten(input_shape=(1,))) 
model.add( Dense(units=1, activation='linear') )

model.compile( optimizer=SGD(learning_rate=1e-2), loss='mse')

hist = model.fit( x_data, t_data, epochs=300, verbose=1 )
```

### 에러변화표

```python
import matplotlib.pyplot as plt

plt.plot(hist.history['loss'], label='loss')
plt.xlabel('Epochs')
plt.ylabel('Error')
plt.legend()
plt.show()
```

![image](https://github.com/yony-k/yony-k.github.io/assets/109204976/48b9a773-7744-4bf7-8edf-db47fb69f274)

- hist.history['loss'] : history는 dict 형태로 loss 라는 키를 이용해 에러의 변화값을 가지고 있다. 
  - 이를 이용해 표를 만든다.
- label은 이름을 붙이는 것

### 가중치, 편향값 구하기

```python
model.layers[1].weights
```

```python
[<tf.Variable 'dense/kernel:0' shape=(1, 1) dtype=float32, numpy=array([[1.0667104]], dtype=float32)>,
 <tf.Variable 'dense/bias:0' shape=(1,) dtype=float32, numpy=array([1.5628735], dtype=float32)>
```

- 가중치 : 1.0667104
- 편향값 : 1.5628735
- 최종식 : $ y = 1.0667104 * x + 1.5628735 $